Note: the code in this repository was used for initial analysis but is no longer implemented, please see the folder 09_fusion_simulations

# Experiment

Leukemia patient sample

# Files and folders

Snakefile: used for running rock_roi_method (see https://github.com/imallona/rock_roi_method). The Snakefile was modified to add additional folders in which tmp files are stored and later deleted. 
config.yaml: used for running rock_roi_method (see https://github.com/imallona/rock_roi_method) for the patient sample. 

qmd: files for analysis of count tables and generation of plots
simulation_patient_cell_lines: scripts and simulated .fastq files to test the fusion detection workflow. The simulated reads were generated by hand and were used to test the workflow which was used for the analysis of the datasets from both patient and cell lines. The workflow.sh script includes a STARsolo call to align TSO data without running the full rock_roi_method workflow and the script can thus be run independently. 
workflow: workflow used for analysis of the fusions in the leukemia patient dataset. The fusion detection script is run on the TSO .bam file generated by the rock_roi_method Snakemake workflow and thus needs to be run following this step. 

The script run.sh is used to define the parameters used in the workflow.sh script and to run the script. The script should be run in the cloned repository in the 07_leukemia_patient_workflow/simulation_patient_cell_lines folder

Installs neede to run the workflow:
- STAR: version 2.7.10b was used for the analysis
- bwa: bwa 0.7.18 was used for the analysis
- samtools: samtools 1.21 was used for the analysis <br />
The installs can be done with the run.sh file

Files needed to run the simulation: 
- BCR_ABL.fa: custom .fa file containing the cDNAs covering the fusion region to be detected
- BD_CLS{1,2,3}: BD Rhapsody cell labels to run STARsolo to generate the TSO .bam file. This step is not needed for the full workflow as the TSO .bam file is generated by the rock_roi_method 
- combined_r1.fastq and combined_r2.fastq: simulated .fastq files. The r1 file contains information on the barcode and UMI, while the r2 contains information on BCR ABL cDNAs
- regions.bed: .bed file containing information on the BCR and ABL1 coordinates
- run.sh: file to run the workflow.sh file and specify the parameters needed for the analysis
- workflow.sh: workflow

Files needed to run the workflow (on real data): 
- custom .fa file: contains the cDNAs covering the fusion region to be detected. The file is found in the simulation_patient_cell_lines folder (BCR_ABL.fa) 
- STAR indexed genome: used for running STAR fusion
- TSO .bam file generated with the rock_roi_method <br />
The script run.sh is used to define the parameters used in the workflow.sh script and to run the script



